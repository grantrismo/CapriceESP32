correct Z80 setup
=================

*E*Native->Z80p: 0x55c2f3f9e618
*E*NativeCPC->Z80->SZ 0x55c2f3f9e980

NativeCPC->contextP + CONTEXT_OFFSET_Z80
80,e9,f9,f3,c2,55, 0, 0,80,ea,f9,f3,c2,55, 0, 0,80
eb,f9,f3,c2,55, 0, 0,80,ec,f9,f3,c2,55, 0, 0,80
ed,f9,f3,c2,55, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0,22
f7, 0, 0,c0,f6, 0, 0, 0,14, 0, 0,b0,1b, 0, 0,dc
5f, 0, 0,ee,bf, 0, 0, 8,39, 0, 0, 0, 5, 0, 0, 0
14, 0, 0,88,1f, 0, 0, 8,a5, 0, 0, 0,a6, 0, 0, 0
 0, 0, 0,ad,10, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 4
 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
 0, 0, 0,ff,ff,ff,ff,

(NativeCPC->Z80)
80,e9,f9,f3,c2,55, 0, 0,80,ea,f9,f3,c2,55, 0, 0,80
eb,f9,f3,c2,55, 0, 0,80,ec,f9,f3,c2,55, 0, 0,80
ed,f9,f3,c2,55, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0,22
f7, 0, 0,c0,f6, 0, 0, 0,14, 0, 0,b0,1b, 0, 0,dc
5f, 0, 0,ee,bf, 0, 0, 8,39, 0, 0, 0, 5, 0, 0, 0
14, 0, 0,88,1f, 0, 0, 8,a5, 0, 0, 0,a6, 0, 0, 0
 0, 0, 0,ad,10, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 4
 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
 0, 0, 0,ff,ff,ff,ff,


 wrong Z80 setup
 ================
NativeCPC->contextP + CONTEXT_OFFSET_Z80

0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0,22
f7, 0, 0,c0,f6, 0, 0, 0,14, 0, 0,b0,1b, 0, 0,dc
5f, 0, 0,ee,bf, 0, 0, 8,39, 0, 0, 0, 5, 0, 0, 0
14, 0, 0,88,1f, 0, 0, 8,a5, 0, 0, 0,a6, 0, 0, 0
0, 0, 0,ad,10, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 4
0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
0, 0, 0,ff,ff,ff,ff,

(NativeCPC->Z80)
10,e9,e2,fb,e1,55, 0, 0,b0,ed,e2,fb,e1,55, 0, 0,10
17,e4,fb,e1,55, 0, 0,50,80,e2,fb,e1,55, 0, 0,80
f8,e3,fb,e1,55, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0,40
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
0, 0, 0, 0, 0, 0, 0,ff,ff, 0, 0,ff,ff, 0, 0, 0
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
0, 0, 0,ff,ff,ff,ff,

new Update
===========
NativeCPC->contextP + CONTEXT_OFFSET_Z80
e0,ef,66,2a,44,56, 0, 0,c0,a8,62,2a,44,56, 0, 0,f0
 c,63,2a,44,56, 0, 0,e0,d4,62,2a,44,56, 0, 0,d0
aa,66,2a,44,56, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0,22
f7, 0, 0,c0,f6, 0, 0, 0,14, 0, 0,b0,1b, 0, 0,dc
5f, 0, 0,ee,bf, 0, 0, 8,39, 0, 0, 0, 5, 0, 0, 0
14, 0, 0,88,1f, 0, 0, 8,a5, 0, 0, 0,a6, 0, 0, 0
 0, 0, 0,ad,10, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 4
 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
 0, 0, 0,ff,ff,ff,ff,

-> expected:
80,e9,f9,f3,c2,55, 0, 0,80,ea,f9,f3,c2,55, 0, 0,80
eb,f9,f3,c2,55, 0, 0,80,ec,f9,f3,c2,55, 0, 0,80
ed,f9,f3,c2,55, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0,22
f7, 0, 0,c0,f6, 0, 0, 0,14, 0, 0,b0,1b, 0, 0,dc
5f, 0, 0,ee,bf, 0, 0, 8,39, 0, 0, 0, 5, 0, 0, 0
14, 0, 0,88,1f, 0, 0, 8,a5, 0, 0, 0,a6, 0, 0, 0
 0, 0, 0,ad,10, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 4
 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
 0, 0, 0,ff,ff,ff,ff,

 Looks good: registers are restored, calloc pointer are ok!

NativeCPC->Z80)
e0,ef,66,2a,44,56, 0, 0,c0,a8,62,2a,44,56, 0, 0,f0
 c,63,2a,44,56, 0, 0,e0,d4,62,2a,44,56, 0, 0,d0
aa,66,2a,44,56, 0, 0, c, 0, 0, 0, 0, 0, 0, 0,40
 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
 0, 0, 0, 0, 0, 0, 0,ff,ff, 0, 0,ff,ff, 0, 0, 0
 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
 0, 0, 0,ff,ff,ff,ff,
